var FileZip=function(){var a=this;this.allFiles=[],this.standardFolderObject={path:"",new:async function(e,t,n){if(t=a.formatName(t),"file"==e){var r=await new Uint8Array(await n.arrayBuffer());a.allFiles.push({name:this.path+t,data:r})}else if("folder"==e){a.allFiles.push({name:this.path+t+"/",data:new Uint8Array});var l={...Object.assign({},a.standardFolderObject)};return l.path=this.path+t+"/",l}}},this.formatName=function(a){return a=(a=(a=(a=(a=(a=(a=(a=a.replace(RegExp("[\xc1\xc0\xc2\xc3]","gi"),"a")).replace(RegExp("[\xc9\xc8\xca]","gi"),"e")).replace(RegExp("[\xcd\xcc\xce]","gi"),"i")).replace(RegExp("[\xd3\xd2\xd4\xd5]","gi"),"o")).replace(RegExp("[\xda\xd9\xdb]","gi"),"u")).replace(RegExp("[\xc7]","gi"),"c")).replace("/","_")).replace("-","_")},this.new=async function(e,t,n){if(t=a.formatName(t),"file"==e){var r=await new Uint8Array(await n.arrayBuffer());return a.allFiles.push({name:t,data:r}),r}if("folder"==e){a.allFiles.push({name:t+"/",data:new Uint8Array});var l={...Object.assign({},a.standardFolderObject)};return l.path=t+"/",l}},this.generate=function(){var e=a.allFiles,t=function(){for(var a,e=[],t=0;t<256;t++){a=t;for(var n=0;n<8;n++)a=1&a?3988292384^a>>>1:a>>>1;e[t]=a}return e}();function n(a,e,t,...n){var r=new DataView(e.buffer);n.forEach((e,n)=>16==a?r.setUint16(t+2*n,e,!0):r.setUint32(t+4*n,e,!0))}var r=[],l=new TextEncoder,i=0,c=0;return e.forEach(a=>{var e=l.encode(a.name),h=new Uint8Array(30+e.length),s=function a(e){for(var n=-1,r=0;r<e.length;r++)n=n>>>8^t[(n^e[r])&255];return(-1^n)>>>0}(a.data);n(32,h,0,67324752),n(32,h,14,s,a.data.length,a.data.length),n(16,h,26,a.name.length),h.set(e,30),a.header=h,a.offset=i,r.push(h),r.push(a.data),a.crcData=new Uint8Array(46+e.length),n(32,a.crcData,0,33639248),n(32,a.crcData,16,s,a.data.length,a.data.length),n(16,a.crcData,28,a.name.length),n(32,a.crcData,42,i),a.crcData.set(e,46),c+=a.crcData.length,i+=a.header.length+a.data.length}),e.forEach(a=>r.push(a.crcData)),n(32,new Uint8Array(22),0,101010256),n(16,new Uint8Array(22),8,e.length,e.length),n(32,new Uint8Array(22),12,c,i),r.push(new Uint8Array(22)),new Blob(r,{type:"application/zip"})}};
